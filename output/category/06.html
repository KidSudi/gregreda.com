<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<title>Greg Reda | Home</title>
	<meta name="google-site-verification" content="AgIAQN_qsniIQWOq659Bnhzx-LZts2FdgP1kLgtQg-k" />
	<meta name="description" content="">
	<meta name="author" content="Greg Reda">

	<!-- Facebook Open Graph
  ================================================== -->
  <meta property="og:title" content="Greg Reda: Data geek in Chicago.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.gregreda.com">
  <meta property="og:image" content="http://www.gregreda.com/theme/images/avatar.jpg">
  <meta property="og:description" content="Greg Reda is a Chicagoan focused on analyzing data to provide insight and drive decisions. He also loves stats, visualization, beer, and music.">

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="../theme/css/base.css">
	<link rel="stylesheet" href="../theme/css/skeleton.css">
	<link rel="stylesheet" href="../theme/css/layout.css">
	<link rel="stylesheet" href="../theme/css/simply.css">
	<link rel="stylesheet" href="../theme/css/pygments.css">
	<link rel="stylesheet" href="../theme/css/font-awesome.css">
	<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>

	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- JavaScript
	=================================================== -->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<!-- <script type="text/javascript">
	  function trackOutboundLink(link, category, action) {
	    try { 
	      _gaq.push(['_trackEvent', category , action]); 
	    } catch(err){}
	   
	    setTimeout(function() { document.location.href = link.href; }, 100);
	  }
	</script> -->

	<!-- Favicons
	================================================== -->
	<!-- <link rel="shortcut icon" href="./theme/images/favicon.ico"> -->
	<link rel="apple-touch-icon" href="./theme/images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="./theme/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="./theme/images/apple-touch-icon-114x114.png">

</head>
<body>



	<!-- Primary Page Layout
	================================================== -->
	<div class="container">
		<div id="sidebar" class="three columns">
			<a href=".."><img id="avatar" src="../theme/images/avatar.jpg"></img></a>
			<h3 id="logo"><a href="..">Greg Reda</a></h3>
	    <p id="bio">Hi. I'm a data analyst at <a href="http://grubhub.com">GrubHub</a> in Chicago. I'm obsessed with all things data, statistics, music, and craft beer.</p>
	    <!-- <br />
	    <p>I analyze data in order to solve problems and provide some useful insights. If you have some curiosities and some data, you should send me an email.</p> -->
	    <hr class="small" /> 
    	<div id="social">
    		<a class="icon" href="https://twitter.com/gjreda" title="Twitter"><i class="icon-twitter"></i></a>
    		<a class="icon" href="https://github.com/gjreda" title="GitHub"><i class="icon-github"></i></a>
    		<a class="icon" href="http://linkedin.com/in/gjreda" title="LinkedIn"><i class="icon-linkedin"></i></a>
				<a class="icon" href="https://last.fm/user/gjreda" title="LastFM"><i class="icon-music"></i></a>
    		<a class="icon" href="mailto:gjreda@gmail.com?subject=Hi" title="E-Mail"><i class="icon-envelope"></i></a>
    		<a class="icon" href="http://www.gregreda.com/feeds/all.atom.xml" title="Subscribe (Atom)"><i class="icon-rss"></i></a>
    	</div> <!-- social -->
    	<!-- <a style="text-align:center;" href="../about/">About Me</a> -->
		</div> <!-- sidebar -->

		<section id="content" class="twelve columns offset-by-one">
			
  
    <h3 class="article-title"><a href="2013/06/03/join-vs-exists-vs-in" title="Join vs Exists vs In (SQL)">Join vs Exists vs In (SQL)</a></h3>
    
    <h6 class="article-date">June 03, 2013</h6>

    <!-- <div class="article-summary">
    <p>Last weekend, I came across <a href="http://en.wikipedia.org/wiki/Jeff_Atwood">Jeff Atwood</a>'s excellent <a href="http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html">visual explanation of SQL joins</a> on Hacker News.</p>
<p>It reminded me of teaching SQL to the incoming batch of <a href="http://www.pwc.com/us/en/forensic-services/technology-solutions.jhtml">PwC FTS</a> associates a few years ago.  Not many of them had prior programming experience, much less SQL exposure, so it was ...</p> <a class="read-more" href="2013/06/03/join-vs-exists-vs-in">Read more</a>
    </div> -->
  <!-- <div class="article-content">
    <p>Last weekend, I came across <a href="http://en.wikipedia.org/wiki/Jeff_Atwood">Jeff Atwood</a>'s excellent <a href="http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html">visual explanation of SQL joins</a> on Hacker News.</p>
<p>It reminded me of teaching SQL to the incoming batch of <a href="http://www.pwc.com/us/en/forensic-services/technology-solutions.jhtml">PwC FTS</a> associates a few years ago.  Not many of them had prior programming experience, much less SQL exposure, so it was a fun week to learn how well us instructors could teach the topic.</p>
<p>Most of them intuitively picked up on how the IN clause worked, but struggled with EXISTS and JOINs initially.  An explanation that always seemed to help illustrate the concept was to show that often you can write the exact same query using an IN, EXISTS, or a JOIN.</p>
<p>As an example, let's assume the following two tables, which we'll call <em>tableA</em> and <em>tableB</em>.</p>
<div class="codehilite"><pre><span class="n">id</span>  <span class="n">name</span>    <span class="n">id</span>  <span class="n">title</span>
<span class="o">--</span>  <span class="o">----</span>    <span class="o">--</span>  <span class="o">----</span>
<span class="mi">1</span>   <span class="n">Kenny</span>   <span class="mi">1</span>   <span class="n">Analyst</span>
<span class="mi">1</span>   <span class="n">Rob</span>     <span class="mi">2</span>   <span class="n">Sales</span>
<span class="mi">4</span>   <span class="n">Molly</span>   <span class="mi">3</span>   <span class="n">Manager</span>
<span class="mi">1</span>   <span class="n">Greg</span>
<span class="mi">2</span>   <span class="n">John</span>
</pre></div>


<p>If we wanted to get everyone that's an Analyst, we could do the following:</p>
<div class="codehilite"><pre><span class="k">SELECT</span>  <span class="o">*</span>
<span class="k">FROM</span>    <span class="n">tableA</span>
<span class="k">WHERE</span>   <span class="n">tableA</span><span class="p">.</span><span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">tableB</span><span class="p">.</span><span class="n">id</span> <span class="k">FROM</span> <span class="n">tableB</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Analyst&#39;</span><span class="p">);</span>

<span class="c1">-- Returns 3 records - Kenny, Rob, and Greg</span>
</pre></div>


<p>For those not very familiar with SQL, this should be relatively easy to understand.  We have written a <a href="http://en.wikipedia.org/wiki/Correlated_subquery">subquery</a> that will get the <em>id</em> for the <em>Analyst</em> title in <em>tableB</em>.  Using IN, we can then grab all of the employees from <em>tableA</em> who have that title.</p>
<p>While IN statements are fairly intuitive, they're often less efficient than the same query written as a JOIN or EXISTS statement would be.</p>
<p>To produce the same results as above, we can do the following:</p>
<div class="codehilite"><pre><span class="c1">-- EXISTS</span>
<span class="k">SELECT</span>  <span class="o">*</span>
<span class="k">FROM</span>    <span class="n">tableA</span>
<span class="k">WHERE</span>   <span class="k">EXISTS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">tableB</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Analyst&#39;</span> <span class="k">AND</span> <span class="n">tableA</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">tableB</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>

<span class="c1">-- JOIN (INNER is the default when only JOIN is specified)</span>
<span class="k">SELECT</span>  <span class="o">*</span>
<span class="k">FROM</span>    <span class="n">tableA</span>
<span class="k">JOIN</span>    <span class="n">tableB</span>
    <span class="k">ON</span>  <span class="n">tableA</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">tableB</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span>   <span class="n">tableB</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Analyst&#39;</span><span class="p">;</span>
</pre></div>


<p>In most cases, EXISTS or JOIN will be much more efficient (and faster) than an IN statement.  Why?</p>
<p>When using an IN combined with a subquery, the database must process <em>the entire subquery</em> first, then process the overall query as a whole, matching up based on the relationship specified for the IN.</p>
<p>With an EXISTS or a JOIN, the database will return true/false while checking the relationship specified.  Unless the table in the subquery is <em>very</em> small, EXISTS or JOIN will perform much better than IN.</p>
<p>Furthermore, writing the query as a JOIN gives us some additional flexibility to easily return all of the employees if we'd like, or to even check for employees who do not have a title (orphan records).</p>
<div class="codehilite"><pre><span class="c1">-- Return employees and display their title</span>
<span class="k">SELECT</span>  <span class="o">*</span>
<span class="k">FROM</span>    <span class="n">tableA</span>
<span class="k">JOIN</span>    <span class="n">tableB</span>
    <span class="k">ON</span>  <span class="n">tableA</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">tableB</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
<span class="c1">-- 1 Kenny  1 Analyst</span>
<span class="c1">-- 1 Rob    1 Analyst</span>
<span class="c1">-- 1 Greg   1 Analyst</span>
<span class="c1">-- 2 John   2 Sales</span>

<span class="c1">-- Which employees do not have a title?</span>
<span class="k">SELECT</span>  <span class="o">*</span>
<span class="k">FROM</span>    <span class="n">tableA</span>
<span class="k">LEFT</span> <span class="k">JOIN</span>   <span class="n">tableB</span>
    <span class="k">ON</span>  <span class="n">tableA</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">tableB</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span>   <span class="n">tableB</span><span class="p">.</span><span class="n">id</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
<span class="c1">-- 4 Molly  NULL NULL</span>
</pre></div>


<p>In the first query above, Molly falls out because she does not have a title.  If we would have liked her to appear in the record set, we could simply change the JOIN to a LEFT JOIN and she would appear with NULL data from <em>tableB</em>.</p>
<p>If you have many IN statements littered throughout your code, you should compare the performance of these queries against an EXISTS or JOIN version of the same query - you'll likely see performance gains.</p>
<p>I hope this illustrated some of the subtle differences between INs, EXISTS, and JOINs.  Questions and feedback in the comments are appreciated.</p>
  </div> -->
  <hr class="large">
  
  
		</section>

		<footer class="twelve columns offset-by-one">
			<!-- <hr class="small"> -->
			<p>Generated with <a href="http://getpelican.com">Pelican</a>. Layout done with <a href="http://getskeleton.com">Skeleton</a>. Icons are <a href="http://fortawesome.github.com/Font-Awesome/">Font Awesome</a>. Hosted on <a href="http://aws.amazon.com/s3/">S3</a>.
		</footer>
		
	</div><!-- container -->

<!-- Google Analytics -->
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34295039-1']);
  _gaq.push(['_setDomainName', 'gregreda.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	<!-- <script type="text/javascript">
		$(document).ready(function() {
			$("a").click(function() {
				trackOutboundLink(this, "Outbound Links", this.href.toString());
				return false;
			})
		})
	</script> -->

<!-- End Document
================================================== -->
</body>
</html>